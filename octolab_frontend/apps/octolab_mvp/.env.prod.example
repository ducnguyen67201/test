# OctoLab Production Environment Configuration
# =============================================
#
# Copy this file to .env.prod and fill in the values:
#   cp .env.prod.example .env.prod
#   chmod 600 .env.prod
#
# Then run: ./deploy.sh
#
# SECURITY: Never commit .env.prod to version control!

# =============================================================================
# Database Configuration
# =============================================================================
# PostgreSQL credentials (used by both postgres container and backend)
DB_USER=octolab
DB_PASSWORD=<generate-secure-password>
DB_NAME=octolab

# =============================================================================
# Security Secrets (REQUIRED)
# =============================================================================
# JWT signing secret - generate with:
#   openssl rand -hex 32
SECRET_KEY=<generate-with-openssl-rand-hex-32>

# Evidence HMAC secret - generate with:
#   openssl rand -hex 32
EVIDENCE_HMAC_SECRET=<generate-with-openssl-rand-hex-32>

# =============================================================================
# Application Settings
# =============================================================================
# Logging level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Admin email addresses (comma-separated) for privileged operations
OCTOLAB_ADMIN_EMAILS=admin@example.com

# Allow self-service user registration (set to true for open signups)
ALLOW_SELF_SIGNUP=false

# =============================================================================
# Firecracker MicroVM Configuration
# =============================================================================
# Paths to firecracker assets on the HOST
MICROVM_KERNEL_PATH=/var/lib/octolab/firecracker/vmlinux
MICROVM_ROOTFS_BASE_PATH=/var/lib/octolab/firecracker/rootfs.ext4
FIRECRACKER_BIN=/usr/local/bin/firecracker
JAILER_BIN=/usr/local/bin/jailer

# =============================================================================
# VNC/noVNC Configuration
# =============================================================================
# Public URL for VNC access (adjust to your domain)
VNC_BASE_URL=https://dev.cyberoctopusvn.com/vnc/vnc.html
HACKVM_PUBLIC_HOST=dev.cyberoctopusvn.com

# noVNC bind address (localhost for security, proxy handles external access)
NOVNC_BIND_ADDR=127.0.0.1
NOVNC_PORT_MIN=30000
NOVNC_PORT_MAX=39999

# =============================================================================
# Guacamole Configuration (Optional)
# =============================================================================
# Enable Guacamole for remote desktop access
GUAC_ENABLED=false

# Guacamole base URL (internal)
GUAC_BASE_URL=http://127.0.0.1:8081/guacamole

# Guacamole admin credentials
GUAC_ADMIN_USER=guacadmin
GUAC_ADMIN_PASSWORD=<change-from-default>

# Fernet encryption key for per-lab Guacamole passwords
# Generate with: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# IMPORTANT: Once set, NEVER change this key or existing labs will fail!
GUAC_ENC_KEY=<generate-fernet-key>

# guacd container name (for network connect/disconnect)
GUACD_CONTAINER_NAME=octolab-guacd

# =============================================================================
# Quotas and Limits
# =============================================================================
# Maximum concurrent active labs per user
MAX_ACTIVE_LABS_PER_USER=2

# Maximum lab creation rate per user per hour
MAX_LAB_CREATES_PER_HOUR_PER_USER=10

# Default lab time-to-live in minutes
DEFAULT_LAB_TTL_MINUTES=120

# =============================================================================
# Teardown Worker
# =============================================================================
# Enable background worker for cleaning up finished labs
TEARDOWN_WORKER_ENABLED=true
TEARDOWN_WORKER_INTERVAL_SECONDS=5.0

# =============================================================================
# Internal API Token (for Falco integration)
# =============================================================================
# Generate with: openssl rand -hex 32
INTERNAL_TOKEN=<generate-with-openssl-rand-hex-32>

# =============================================================================
# Port Configuration
# =============================================================================
# Ports exposed on the host
BACKEND_PORT=8000
FRONTEND_PORT=80
